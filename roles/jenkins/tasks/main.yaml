- name: Ensure Jenkins Repository is Installed
  yum_repository:
    name: jenkins
    state: present
    description: Official Jenkins Yum Repo
    baseurl: https://pkg.jenkins.io/redhat-stable/jenkins.repo
    gpgkey: https://pkg.jenkins.io/redhat-stable/jenkins.io.key
    gpgcheck: yes
    enabled: yes
- name: Ensure java & Jenkins is Installed
  yum :
    name:
      - java-11-openjdk
      - jenkins
      - git
      - ngnix
    state: present
- name: Enable and Start the Service
  loop: "{{ apps }}"
  service:
    name: "{{ item }}"
  enabled: yes
  state: started
- name: init jenkins with groovy scripts
  loop: "{{ scripts }}"
  ansible.builtin.templates:
    src: "{{ item }}"
    dest: /var/lib/jenkins/init.groovy.d/{{ item }}
  notify: restart jenkins